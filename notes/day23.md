[5강 내용은 추가 예정]

### [Graph 6강] 그래프를 추천시스템에 어떻게 활용할까? (기본)
#### 2. 내용 기반 추천시스템
+ 내용 기반(Content-based) 추천은 각 사용자가 구매/만족했던 상품과 유사한 것을 추천하는 방법
  + 동일한 장르의 영화를 추천
  + 동일한 감독의 영화 혹은 동일 배우가 출현한 영화를 추천하는 것
  + 동갑의 같은 학료를 졸업한 사람을 친구로 추천하는 것

#### 3. 내용 기반 추천 시스템의 원리
+ 1) 첫 단계는 사용자가 선호했던 상품들의 상품 프로필(Item Profile)을 수집하는 단계, 상품 프로필이란 해당 상품의 특성을 나열한 벡터(원-핫 인코딩)를 의미
+ 2) 사용자 프로필(User Profile)을 구성하는 단계, 사용자 프로필은 선호한 상품의 상품 프로필을 선호도를 사용하여 가중 평균하여 계산(사용자 프로필 역시 벡터)
    + 선호하는 정도를 가중치로 정의함
+ 3) 사용자 프로필과 다른 상품들의 상품 프로필을 매칭하는 단계, 사용자 프로필 벡터와 상품 프로필 벡터의 코사인 유사도를 계산(즉, 두 벡터 사이각의 코사인 값을 계산)
    + 코사인 유사도가 높을 수록, 해당 사용자가 과거의 선호했던 상품들과 해당 상품이 유사함을 의미
+ 4) 마지막 단계는 사용자에게 상품을 추천하는 단계, 계싼한 코사인 유사도가 높은 상품들을 추천

#### 4. 내용 기반 추천시스템의 장단점
+ 장점
    + 다른 사용자의 구매 기록이 필요하지 않음
    + 독특한 취향의 사용자에게도 추천이 가능
    + 새 상품에 대해서도 추천이 가능
    + 추천의 이유를 제공할 수 있음 (당신은 로맨스 영화를 서호했기 때문에, 새로운 로맨스 영화를 추천)
+ 단점
    + 상품에 대한 부가 정보가 없는 경우에 사용이 불가능
    + 구매 기록이 없는 사용자에게는 사용이 불가능
    + 과적합(Overfitting)으로 지나치게 협소한 추천을 할 위험이 있음

#### 5. 협업 필터링 추천시스템
+ 사용자-사용자 협업 필터링은 다음 세단계로 이루어짐
    + 1) 추천의 대상 사용자를 x라고 할 경우, x와 유사한 취향의 사용자를 찾음
    + 2) 유사한 취향의 사용자들이 선호한 상품을 찾음
    + 3) 이 상품들을 x에게 추천

#### 6. 협업 필터링의 원리
+ 사용자-사용자 협업 필터링의 핵심은 유사한 취향의 사용자를 찾는 것
+ 취향의 유사성은 상관 계수(Correlation Coefficient)를 통해 측정
    + 사용자 x의 상품 s에 대한 평점을 r_{xs} 라고 함
    + 사용자 x가 매긴 평균 평점을 \overline{r_{x}라고 함
    + 사용자 x와 y가 공동 구매한 상품들을 S_{xy}라고 함
    + 사용자 x와 y의 취향의 유사도는 아래 수식으로 계산(두 사용자의 평점 기준이 동일할 경우에는 양수 값, 다를 경우에는 음수 값을 반환)
        + (값 - 평균)을 기준으로한 코사인 유사도라고 생각

![캡처w](https://user-images.githubusercontent.com/44515744/109017974-081e3b80-76fb-11eb-84de-f9783730724b.JPG)

+ 구체적으로 취향의 유사도를 가중치로 사용한 평점의 가중 평균을 통해 평점을 추정함
    + 사용자 x의 상품 s에 대한 평점은 r_{xs}를 추정하는 경우를 생각함
    + 앞서 설명한 상관 계수를 이용하여 상품 s를 구매한 사용자 중에 x와 취향이 가장 유사한 k명의 사용자 N(x;s)를 뽑습니다.
+ 평점 r_{xs}는 아래의 수식을 이용해 추정

![캡처w](https://user-images.githubusercontent.com/44515744/109023494-305c6900-7700-11eb-969b-4d8c20b7305a.JPG)

+ 즉, 취향의 유사도를 가중치로 사용한 평점의 가중 평균을 계산함
+ 마지막 단계는 추정한 평점이 가장 높은 상품을 추천하는 단계
    + 추천의 대상 사용자를 x라고 하면, x가 구매하지 않은 상품 각각에 대해 평점을 추정함
    + 추정한 평점이 가장 높은 상품들을 x에게 추천함

#### 7. 협업 필터링의 장단점
+ 장점
    + 상품에 대한 부가 정보가 없는 경우에도 사용이 가능
+ 단점
    + 충분한 수의 평점 데이터가 누적되어야 효과적
    + 새 상품, 새로운 사용자에 대한 추천이 불가능
    + 독특한 취향의 사용자에게는 추천이 어려움

#### 8. 추천 시스템의 평가
+ 평점 데이터는 행렬로 볼 수 있음

![캡처](https://user-images.githubusercontent.com/44515744/109027071-c219a580-7703-11eb-9bc9-7d06af096e18.JPG)

+ 추천 시스템의 정확도
    + 1) 특정 사용자가 상품을 구매하면 행렬에 평점 정보를 입력하고 상품을 구매하지 않으면 빈칸으로 입력됨
    + 2) 데이터를 훈련 데이터, 평가 데이터를 구분하고 평가데이터는 값이 주어지지 없다고 가정
    + 3) 훈련 데이터를 이용해서 가리워진 평가 데이터의 평점을 추정함
    + 4) 추정한 평점과 실제 평가 데이터를 비교하여 오차를 측정함
        + 오차를 측정하는 지표로는 평균 제곱 오차(Mean Squared Error, MSE)가 많이 사용됨
        + 평가 데이터 내의 평점들의 집합을 T라고 함
        + 평균 제곱 오차는 아래 수식으로 계산함, |T|는 집합 T의 요소의 개수를 의미

    ![캡처](https://user-images.githubusercontent.com/44515744/109027185-df4e7400-7703-11eb-9c12-e8d5f1450c96.JPG)
    
    + 평균 제곱근 오차(Root Mean Squared Error, RMSE)도 많이 사용됨 

    ![캡처](https://user-images.githubusercontent.com/44515744/109027330-0442e700-7704-11eb-88f2-d23e408d15b8.JPG)
    
+ 이 밖에도 다양한 지표가 사용됨
    + 추정한 평점으로 순위를 매긴 후, 실제 평점으로 매긴 순위와의 상관 계수를 계산함
    + 추천한 상품 중 실제 구매로 이루어진 것의 비율을 측정하기도 함
    + 추천의 순서 혹은 다양성까지 고려하는 
